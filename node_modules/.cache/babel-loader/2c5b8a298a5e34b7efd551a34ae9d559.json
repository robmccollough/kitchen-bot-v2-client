{"ast":null,"code":"import _slicedToArray from \"/Users/peytongillenwater/Desktop/Classes/COMP426/KitchenBot/kitchen-bot-v2-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/peytongillenwater/Desktop/Classes/COMP426/KitchenBot/kitchen-bot-v2-client/src/components/new/login/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { BrowserRouter as Router, Route, Redirect, Link } from \"react-router-dom\";\nimport { Form, Input, Button, Header, Container, Segment } from \"semantic-ui-react\";\nimport useForm from \"react-hook-form\";\nimport axios from \"axios\";\nimport history from \"../history\";\nimport \"./index.css\";\n\nconst Login = props => {\n  console.log(props);\n\n  const _useForm = useForm(),\n        handleSubmit = _useForm.handleSubmit,\n        register = _useForm.register,\n        setValue = _useForm.setValue,\n        setError = _useForm.setError;\n\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        isLoggedIn = _useState2[0],\n        toggleLogin = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        errMessage = _useState4[0],\n        setErrMessage = _useState4[1];\n\n  const _useState5 = useState(false),\n        _useState6 = _slicedToArray(_useState5, 2),\n        access_token = _useState6[0],\n        setAccessToken = _useState6[1];\n\n  useEffect(() => {\n    if (props.location.search.includes(\"access_token\")) {\n      setAccessToken(props.location.search.replace(\"?access_token=\", \"\"));\n    }\n  }, []); //emulating componentDidMount\n\n  useEffect(() => {\n    register({\n      name: \"email\"\n    }, {\n      required: true\n    });\n    register({\n      name: \"password\"\n    }, {\n      required: true\n    });\n  }, []);\n\n  const onSubmit = async values => {\n    return await axios({\n      method: \"post\",\n      url: \"\".concat(process.env.REACT_APP_SERVER_PATH, \"/login\"),\n      data: {\n        email: values.email,\n        password: values.password,\n        gm_access_token: access_token || false\n      }\n    }).then(async result => {\n      if (result.data.authenticated) {\n        history.push(\"/login\");\n        toggleLogin(true);\n      } else {\n        console.log(result);\n        setErrMessage(result.data.err);\n      }\n    }).catch(err => {\n      console.log(err);\n      setErrMessage(err.msg);\n    });\n  };\n\n  return isLoggedIn ? React.createElement(Redirect, {\n    exact: true,\n    from: \"login\",\n    to: \"home\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }) : React.createElement(\"div\", {\n    className: \"login-page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(Form, {\n    onSubmit: handleSubmit(onSubmit),\n    className: \"login-form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(Header, {\n    size: \"large\",\n    content: \"Login\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }), React.createElement(Input, {\n    name: \"email\",\n    placeholder: \"Email\",\n    label: \"Email\",\n    size: \"large\",\n    onChange: e => setValue(\"email\", e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }), React.createElement(Input, {\n    name: \"password\" // type=\"password\"\n    ,\n    placeholder: \"Password\",\n    size: \"large\",\n    label: \"Password\",\n    onChange: e => setValue(\"password\", e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }), React.createElement(Button, {\n    className: \"login-button\",\n    type: \"submit\",\n    content: \"Login\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }), errMessage && React.createElement(Form.Field, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, React.createElement(Segment, {\n    inverted: true,\n    raised: true,\n    color: \"red\",\n    content: errMessage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  })), React.createElement(Link, {\n    from: \"/login\",\n    to: \"/register\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, \"Dont have an acccount? Create One\")));\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/peytongillenwater/Desktop/Classes/COMP426/KitchenBot/kitchen-bot-v2-client/src/components/new/login/index.js"],"names":["React","useState","useEffect","BrowserRouter","Router","Route","Redirect","Link","Form","Input","Button","Header","Container","Segment","useForm","axios","history","Login","props","console","log","handleSubmit","register","setValue","setError","isLoggedIn","toggleLogin","errMessage","setErrMessage","access_token","setAccessToken","location","search","includes","replace","name","required","onSubmit","values","method","url","process","env","REACT_APP_SERVER_PATH","data","email","password","gm_access_token","then","result","authenticated","push","err","catch","msg","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n\tBrowserRouter as Router,\n\tRoute,\n\tRedirect,\n\tLink\n} from \"react-router-dom\";\nimport {\n\tForm,\n\tInput,\n\tButton,\n\tHeader,\n\tContainer,\n\tSegment\n} from \"semantic-ui-react\";\nimport useForm from \"react-hook-form\";\nimport axios from \"axios\";\nimport history from \"../history\";\nimport \"./index.css\";\n\nconst Login = props => {\n\tconsole.log(props);\n\n\tconst { handleSubmit, register, setValue, setError } = useForm();\n\n\tconst [isLoggedIn, toggleLogin] = useState(false);\n\n\tconst [errMessage, setErrMessage] = useState(false);\n\n\tconst [access_token, setAccessToken] = useState(false);\n\n\tuseEffect(() => {\n\t\tif (props.location.search.includes(\"access_token\")) {\n\t\t\tsetAccessToken(props.location.search.replace(\"?access_token=\", \"\"));\n\t\t}\n\t}, []);\n\n\t//emulating componentDidMount\n\tuseEffect(() => {\n\t\tregister({ name: \"email\" }, { required: true });\n\t\tregister({ name: \"password\" }, { required: true });\n\t}, []);\n\n\tconst onSubmit = async values => {\n\t\treturn await axios({\n\t\t\tmethod: \"post\",\n\t\t\turl: `${process.env.REACT_APP_SERVER_PATH}/login`,\n\t\t\tdata: {\n\t\t\t\temail: values.email,\n\t\t\t\tpassword: values.password,\n\t\t\t\tgm_access_token: access_token || false\n\t\t\t}\n\t\t})\n\t\t\t.then(async result => {\n\t\t\t\tif (result.data.authenticated) {\n\t\t\t\t\thistory.push(\"/login\");\n\n\t\t\t\t\ttoggleLogin(true);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(result);\n\t\t\t\t\tsetErrMessage(result.data.err);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log(err);\n\t\t\t\tsetErrMessage(err.msg);\n\t\t\t});\n\t};\n\n\treturn isLoggedIn ? (\n\t\t<Redirect exact from=\"login\" to=\"home\" />\n\t) : (\n\t\t<div className=\"login-page\">\n\t\t\t<Form onSubmit={handleSubmit(onSubmit)} className=\"login-form\">\n\t\t\t\t<Header size=\"large\" content=\"Login\" />\n\t\t\t\t<Input\n\t\t\t\t\tname=\"email\"\n\t\t\t\t\tplaceholder=\"Email\"\n\t\t\t\t\tlabel=\"Email\"\n\t\t\t\t\tsize=\"large\"\n\t\t\t\t\tonChange={e => setValue(\"email\", e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<Input\n\t\t\t\t\tname=\"password\"\n\t\t\t\t\t// type=\"password\"\n\t\t\t\t\tplaceholder=\"Password\"\n\t\t\t\t\tsize=\"large\"\n\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\tonChange={e => setValue(\"password\", e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<Button className=\"login-button\" type=\"submit\" content=\"Login\" />\n\t\t\t\t{errMessage && (\n\t\t\t\t\t<Form.Field>\n\t\t\t\t\t\t<Segment inverted raised color=\"red\" content={errMessage} />\n\t\t\t\t\t</Form.Field>\n\t\t\t\t)}\n\n\t\t\t\t<Link from=\"/login\" to=\"/register\">\n\t\t\t\t\tDont have an acccount? Create One\n\t\t\t\t</Link>\n\t\t\t</Form>\n\t\t</div>\n\t);\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}